% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gpbspline.R
\name{fit_gpbss_profile}
\alias{fit_gpbss_profile}
\title{Fit GP-on-spline-coefficients model by profile likelihood}
\usage{
fit_gpbss_profile(
  y,
  U,
  F,
  tau,
  R_fun,
  psi_init,
  method = "L-BFGS-B",
  lower = NULL,
  upper = NULL,
  jitter = 1e-08,
  sigma2_df = c("n", "n-q"),
  verbose = FALSE,
  ...
)
}
\arguments{
\item{y}{Numeric response vector (length n).}

\item{U}{Numeric matrix (n x M) tensor-product spline basis.}

\item{F}{Numeric matrix (n x q) mean/trend design.}

\item{tau}{Nonnegative scalar noise-to-signal ratio. (For now treated as fixed.)}

\item{R_fun}{Function mapping \code{psi} to an MxM prior covariance \code{R(psi)}.}

\item{psi_init}{Numeric vector initial guess for \code{psi}.}

\item{method}{Optimization method passed to \code{optim}. Default \code{"L-BFGS-B"}.}

\item{lower, upper}{Optional bounds for \code{psi} (used if method supports bounds).}

\item{jitter}{Jitter passed to \code{profile_loglik_gpbss}.}

\item{sigma2_df}{Degrees-of-freedom divisor for \eqn{\hat\sigma^2}, passed through.}

\item{verbose}{Logical; print optimizer progress and final value.}

\item{...}{Additional arguments passed to \code{optim}.}
}
\value{
A list with elements \code{psi_hat}, \code{beta_hat}, \code{sigma2_hat},
  \code{logLik}, \code{optim}, and the fixed \code{tau}.
}
\description{
Optimizes hyperparameters \eqn{\psi} by maximizing the profile log-likelihood
returned by \code{\link{profile_loglik_gpbss}}, and returns the resulting
\eqn{\hat\psi}, \eqn{\hat\beta}, and \eqn{\hat\sigma^2}.
}
